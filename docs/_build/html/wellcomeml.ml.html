

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>wellcomeml.ml package &mdash; WellcomeML 1.2.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="wellcomeml.spacy package" href="wellcomeml.spacy.html" />
    <link rel="prev" title="wellcomeml.metrics package" href="wellcomeml.metrics.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> WellcomeML
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">WellcomeML’s documentation!</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">List of main modules and descriptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="clustering.html">Clustering text with WellcomeML</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="wellcomeml.html">Core library documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="wellcomeml.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="wellcomeml.datasets.html">wellcomeml.datasets package</a></li>
<li class="toctree-l3"><a class="reference internal" href="wellcomeml.io.html">wellcomeml.io package</a></li>
<li class="toctree-l3"><a class="reference internal" href="wellcomeml.metrics.html">wellcomeml.metrics package</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">wellcomeml.ml package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.attention">wellcomeml.ml.attention module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.bert_classifier">wellcomeml.ml.bert_classifier module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.bert_semantic_equivalence">wellcomeml.ml.bert_semantic_equivalence module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.bert_vectorizer">wellcomeml.ml.bert_vectorizer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.bilstm">wellcomeml.ml.bilstm module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.clustering">wellcomeml.ml.clustering module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.cnn">wellcomeml.ml.cnn module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.constants">wellcomeml.ml.constants module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.doc2vec_vectorizer">wellcomeml.ml.doc2vec_vectorizer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.frequency_vectorizer">wellcomeml.ml.frequency_vectorizer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.keras_utils">wellcomeml.ml.keras_utils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.keras_vectorizer">wellcomeml.ml.keras_vectorizer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.sent2vec_vectorizer">wellcomeml.ml.sent2vec_vectorizer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.similarity_entity_linking">wellcomeml.ml.similarity_entity_linking module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.spacy_classifier">wellcomeml.ml.spacy_classifier module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.spacy_entity_linking">wellcomeml.ml.spacy_entity_linking module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.spacy_knowledge_base">wellcomeml.ml.spacy_knowledge_base module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.spacy_ner">wellcomeml.ml.spacy_ner module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.transformers_tokenizer">wellcomeml.ml.transformers_tokenizer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.vectorizer">wellcomeml.ml.vectorizer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml.voting_classifier">wellcomeml.ml.voting_classifier module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wellcomeml.ml">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="wellcomeml.spacy.html">wellcomeml.spacy package</a></li>
<li class="toctree-l3"><a class="reference internal" href="wellcomeml.viz.html">wellcomeml.viz package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="wellcomeml.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="wellcomeml.html#module-wellcomeml.logger">wellcomeml.logger module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wellcomeml.html#module-wellcomeml.utils">wellcomeml.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wellcomeml.html#module-wellcomeml">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">WellcomeML</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="wellcomeml.html">wellcomeml package</a> &raquo;</li>
        
      <li>wellcomeml.ml package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/wellcomeml.ml.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="wellcomeml-ml-package">
<h1>wellcomeml.ml package<a class="headerlink" href="#wellcomeml-ml-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-wellcomeml.ml.attention">
<span id="wellcomeml-ml-attention-module"></span><h2>wellcomeml.ml.attention module<a class="headerlink" href="#module-wellcomeml.ml.attention" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.attention.FeedForwardAttention">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.attention.</span></span><span class="sig-name descname"><span class="pre">FeedForwardAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.attention.FeedForwardAttention" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tensorflow.python.keras.engine.base_layer.Layer</span></code></p>
<p><a class="reference external" href="https://colinraffel.com/publications/iclr2016feed.pdf">https://colinraffel.com/publications/iclr2016feed.pdf</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.attention.FeedForwardAttention.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.attention.FeedForwardAttention.build" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.attention.FeedForwardAttention.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.attention.FeedForwardAttention.call" title="Permalink to this definition">¶</a></dt>
<dd><p>In: (batch_size, sequence_length, embedding_dimension)
Out: (batch_size, embedding_dimension)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.attention.HierarchicalAttention">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.attention.</span></span><span class="sig-name descname"><span class="pre">HierarchicalAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.attention.HierarchicalAttention" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tensorflow.python.keras.engine.base_layer.Layer</span></code></p>
<p><a class="reference external" href="https://www.aclweb.org/anthology/N16-1174/">https://www.aclweb.org/anthology/N16-1174/</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.attention.HierarchicalAttention.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.attention.HierarchicalAttention.build" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.attention.HierarchicalAttention.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.attention.HierarchicalAttention.call" title="Permalink to this definition">¶</a></dt>
<dd><p>In: (batch_size, sequence_length, embedding_dimension)
Out: (batch_size, sequence_length, embedding_dimension)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.attention.SelfAttention">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.attention.</span></span><span class="sig-name descname"><span class="pre">SelfAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.attention.SelfAttention" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tensorflow.python.keras.engine.base_layer.Layer</span></code></p>
<p><a class="reference external" href="https://papers.nips.cc/paper/7181-attention-is-all-you-need.pdf">https://papers.nips.cc/paper/7181-attention-is-all-you-need.pdf</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.attention.SelfAttention.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.attention.SelfAttention.build" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.attention.SelfAttention.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.attention.SelfAttention.call" title="Permalink to this definition">¶</a></dt>
<dd><p>In: (batch_size, sequence_length, embedding_dimension)
Out: (batch_size, sequence_length, embedding_dimension)</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.bert_classifier">
<span id="wellcomeml-ml-bert-classifier-module"></span><h2>wellcomeml.ml.bert_classifier module<a class="headerlink" href="#module-wellcomeml.ml.bert_classifier" title="Permalink to this headline">¶</a></h2>
<p>Implements BertClassifier, an sklearn compatible BERT
classifier class that can be used for text classification
tasks</p>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_classifier.BertClassifier">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.bert_classifier.</span></span><span class="sig-name descname"><span class="pre">BertClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bert-base-uncased'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multilabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_pt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_classifier.BertClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<p>Class to fine-tune BERT like models for a text
classification task</p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_classifier.BertClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_classifier.BertClassifier.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fine tune BERT to text data and Y vector</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – list or numpy array of texts (n_samples,)</p></li>
<li><p><strong>Y</strong> – list or numpy array of classes (n_samples, n_classes)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_classifier.BertClassifier.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_classifier.BertClassifier.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads model from directory model_path. Tokenizer initialised from param pretrained</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_classifier.BertClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_classifier.BertClassifier.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict vector Y on text data X</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – list or numpy array of texts (n_samples)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy array of predictions Y (n_samples, n_classes)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Y_pred</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_classifier.BertClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_classifier.BertClassifier.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict probabilities for classes on text data X</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – list or numpy arrray of texts (n_samples)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy array of probabilities for each class (n_samples, n_classes)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Y_pred_proba</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_classifier.BertClassifier.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_classifier.BertClassifier.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves model in directory model_path</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_classifier.BertClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_classifier.BertClassifier.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Micro f1 score of X data against ground truth Y</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.bert_semantic_equivalence">
<span id="wellcomeml-ml-bert-semantic-equivalence-module"></span><h2>wellcomeml.ml.bert_semantic_equivalence module<a class="headerlink" href="#module-wellcomeml.ml.bert_semantic_equivalence" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceClassifier">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.bert_semantic_equivalence.</span></span><span class="sig-name descname"><span class="pre">SemanticEquivalenceClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bert'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logging_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensorflow_log_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'logs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<p>Class to fine-tune BERT-type models for semantic equivalence, for example
paraphrase, textual similarity and other NLU tasks</p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceClassifier.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits a sentence similarity model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – List of 2-uples: [(‘Sentence 1’, ‘Sentence 2’), ….]</p></li>
<li><p><strong>y</strong> – list of 0 (not similar) and 1s (similar)</p></li>
<li><p><strong>random_state</strong> – a random state for the train_test_split</p></li>
<li><p><strong>epochs</strong> – number_of epochs</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A fitted model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceClassifier.initialise_models">
<span class="sig-name descname"><span class="pre">initialise_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceClassifier.initialise_models" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceClassifier.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceClassifier.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads model from path</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceClassifier.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the predicted class (0 - for negative and 1 for positive)
for X.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – List of 2-uples: [(‘Sentence 1’, ‘Sentence 2’), ….]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An array of 0s and 1s</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceClassifier.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates scores for model prediction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – List of 2-uples: [(‘Sentence 1’, ‘Sentence 2’), ….]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An array of shape len(X) x 2 with scores for classes 0 and 1</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceClassifier.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceClassifier.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves model to path</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceMetaClassifier">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.bert_semantic_equivalence.</span></span><span class="sig-name descname"><span class="pre">SemanticEquivalenceMetaClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_numerical_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceMetaClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceClassifier" title="wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceClassifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceClassifier</span></code></a></p>
<p>Class to fine tune Semantic Classifier, allowing the possibility of
adding metadata to the classification. Extends
SemanticEquivalenceClassifier, and extends modules for data prep
and model initialisation. Fit, predict, predict_proba remain intact</p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceMetaClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceMetaClassifier.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits semantic classifier</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>list of t-uples</em>) – Assumes that each element x of X has length</p></li>
<li><p><strong>2+n_numerical_features</strong> – </p></li>
<li><p><strong>and</strong> (<em>the first two components are texts</em>) – </p></li>
<li><p><strong>features</strong> (<em>remaining components are numerical</em>) – </p></li>
<li><p><strong>y</strong> – list of 0 (not similar) and 1s (similar)</p></li>
<li><p><strong>random_state</strong> – a random state for the train_test_split</p></li>
<li><p><strong>epochs</strong> – number_of epochs</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of probabilities, of shape len(X) x 2</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceMetaClassifier.initialise_models">
<span class="sig-name descname"><span class="pre">initialise_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceMetaClassifier.initialise_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Extends/overrides super class initialisation of model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceMetaClassifier.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceMetaClassifier.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads metamodel from path</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceMetaClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceMetaClassifier.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates scores for metadata semantic classifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>list of t-uples</em>) – Assumes that each element x of X has length</p></li>
<li><p><strong>2+n_numerical_features</strong> – </p></li>
<li><p><strong>and</strong> (<em>the first two components are texts</em>) – </p></li>
<li><p><strong>features</strong> (<em>remaining components are numerical</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of predictions of length len(X)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceMetaClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceMetaClassifier.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates scores for metadata semantic classifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>list of t-uples</em>) – Assumes that each element x of X has length</p></li>
<li><p><strong>2+n_numerical_features</strong> – </p></li>
<li><p><strong>and</strong> (<em>the first two components are texts</em>) – </p></li>
<li><p><strong>features</strong> (<em>remaining components are numerical</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Numpy array of probabilities, of shape len(X) x 2</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceMetaClassifier.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_semantic_equivalence.SemanticEquivalenceMetaClassifier.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves meta model to path</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_semantic_equivalence.pad">
<span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.bert_semantic_equivalence.</span></span><span class="sig-name descname"><span class="pre">pad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_len</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_semantic_equivalence.pad" title="Permalink to this definition">¶</a></dt>
<dd><p>Old versions of transformers do not pad by default</p>
</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.bert_vectorizer">
<span id="wellcomeml-ml-bert-vectorizer-module"></span><h2>wellcomeml.ml.bert_vectorizer module<a class="headerlink" href="#module-wellcomeml.ml.bert_vectorizer" title="Permalink to this headline">¶</a></h2>
<p>BERT Vectorizer that embeds text using a prertained BERT model</p>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_vectorizer.BertVectorizer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.bert_vectorizer.</span></span><span class="sig-name descname"><span class="pre">BertVectorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bert'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean_second_to_last'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_vectorizer.BertVectorizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_vectorizer.BertVectorizer.bert_embedding">
<span class="sig-name descname"><span class="pre">bert_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_vectorizer.BertVectorizer.bert_embedding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_vectorizer.BertVectorizer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_vectorizer.BertVectorizer.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_vectorizer.BertVectorizer.load_transformed">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">load_transformed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_vectorizer.BertVectorizer.load_transformed" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads transformed embedded vectors</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_vectorizer.BertVectorizer.save_transformed">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">save_transformed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_transformed</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_vectorizer.BertVectorizer.save_transformed" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves transformed embedded vectors</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bert_vectorizer.BertVectorizer.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bert_vectorizer.BertVectorizer.transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.bilstm">
<span id="wellcomeml-ml-bilstm-module"></span><h2>wellcomeml.ml.bilstm module<a class="headerlink" href="#module-wellcomeml.ml.bilstm" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.bilstm.BiLSTMClassifier">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.bilstm.</span></span><span class="sig-name descname"><span class="pre">BiLSTMClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'same'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multilabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['precision',</span> <span class="pre">'recall']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['tensorboard']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_approach</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stopping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bilstm.BiLSTMClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.ClassifierMixin</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bilstm.BiLSTMClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bilstm.BiLSTMClassifier.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bilstm.BiLSTMClassifier.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bilstm.BiLSTMClassifier.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bilstm.BiLSTMClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bilstm.BiLSTMClassifier.predict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bilstm.BiLSTMClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bilstm.BiLSTMClassifier.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bilstm.BiLSTMClassifier.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bilstm.BiLSTMClassifier.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.bilstm.BiLSTMClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.bilstm.BiLSTMClassifier.score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.clustering">
<span id="wellcomeml-ml-clustering-module"></span><h2>wellcomeml.ml.clustering module<a class="headerlink" href="#module-wellcomeml.ml.clustering" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.clustering.TextClustering">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.clustering.</span></span><span class="sig-name descname"><span class="pre">TextClustering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tf-idf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reducer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'umap'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clustering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dbscan'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_reduced</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reducer_random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clustering_random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.clustering.TextClustering" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Basic class for clustering pipelines.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="wellcomeml.ml.clustering.TextClustering.vectorizer">
<span class="sig-name descname"><span class="pre">vectorizer</span></span><a class="headerlink" href="#wellcomeml.ml.clustering.TextClustering.vectorizer" title="Permalink to this definition">¶</a></dt>
<dd><p>The embedding Vectorizer object</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wellcomeml.ml.clustering.TextClustering.reducer">
<span class="sig-name descname"><span class="pre">reducer</span></span><a class="headerlink" href="#wellcomeml.ml.clustering.TextClustering.reducer" title="Permalink to this definition">¶</a></dt>
<dd><p>A dimensionality reduction object</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wellcomeml.ml.clustering.TextClustering.clustering">
<span class="sig-name descname"><span class="pre">clustering</span></span><a class="headerlink" href="#wellcomeml.ml.clustering.TextClustering.clustering" title="Permalink to this definition">¶</a></dt>
<dd><p>A clustering model object</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wellcomeml.ml.clustering.TextClustering.cluster_ids">
<span class="sig-name descname"><span class="pre">cluster_ids</span></span><a class="headerlink" href="#wellcomeml.ml.clustering.TextClustering.cluster_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Ids of the cluster</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wellcomeml.ml.clustering.TextClustering.cluster_names">
<span class="sig-name descname"><span class="pre">cluster_names</span></span><a class="headerlink" href="#wellcomeml.ml.clustering.TextClustering.cluster_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of the clusters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wellcomeml.ml.clustering.TextClustering.cluster_kws">
<span class="sig-name descname"><span class="pre">cluster_kws</span></span><a class="headerlink" href="#wellcomeml.ml.clustering.TextClustering.cluster_kws" title="Permalink to this definition">¶</a></dt>
<dd><p>Keywords for the clusters (only if embedding=tf-idf)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.clustering.TextClustering.break_cluster">
<span class="sig-name descname"><span class="pre">break_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.clustering.TextClustering.break_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Breaks a specific by re-clustering a subset</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.clustering.TextClustering.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.clustering.TextClustering.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits all clusters in the pipeline</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – A list of texts</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A TextClustering object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.clustering.TextClustering.fit_step">
<span class="sig-name descname"><span class="pre">fit_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vectorizer'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.clustering.TextClustering.fit_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal function for partial fitting only a certain step</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.clustering.TextClustering.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.clustering.TextClustering.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the different steps of the pipeline</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<em>str</em>) – path to folder</p></li>
<li><p><strong>components</strong> (<em>list</em><em> or </em><em>'all'</em>) – List of components to load. Options are: ‘embbedded_points’,</p></li>
<li><p><strong>'reduced_points'</strong> – </p></li>
<li><p><strong>'vectorizer'</strong> – </p></li>
<li><p><strong>'reducer'</strong> – </p></li>
<li><p><strong>default</strong> (<em>and 'clustering_model'. By</em>) – </p></li>
<li><p><strong>loads</strong> – </p></li>
<li><p><strong>param</strong> (<em>'all'</em><em> (</em><em>you can get all components by listing the class</em>) – TextClustering.components)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.clustering.TextClustering.merge_clusters">
<span class="sig-name descname"><span class="pre">merge_clusters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictionary</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.clustering.TextClustering.merge_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge cluster based on ids</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.clustering.TextClustering.optimise">
<span class="sig-name descname"><span class="pre">optimise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cluster_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.clustering.TextClustering.optimise" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimises the clustering silhouette based on a parameter grid,
a range on number of clusters and a range on noise.</p>
<p>It is customised to avoid re-fitting of intermediate
steps (vectorizer and reducer) more than necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>iterable</em><em>[</em><em>str</em><em>]</em>) – A list of texts to be clustered</p></li>
<li><p><strong>param_grid</strong> (<em>dict</em>) – A parameter grid, example:
param_grid = {‘reducer’: {‘min_dist’: [0.0, 0.2], ‘n_neighbors’: [2,3,5],
‘metric’: [‘cosine’, ‘euclidean’]},
‘clustering’: {‘min_samples’: [2, 5], ‘eps’: [0.5, 1, 1.5]}}</p></li>
<li><p><strong>n_cluster_range</strong> (<em>2-uple of ints</em>) – A 2-uple describing the max and min number
of clusters (e.g.: (10, 20)). If unset, will just choose the best silhouette</p></li>
<li><p><strong>max_noise</strong> (<em>float in</em><em> [</em><em>0</em><em>,</em><em>1</em><em>]</em>) – The maximum fraction of points unclustered. Default: 0.2</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>A dictionary of results.</p>
<p>The function returns a dictionary containing  “params_list”, “silhouette”
(the silhouette for each parameter) and “best_clustering”
(the best clustering parameters)</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.clustering.TextClustering.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.clustering.TextClustering.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the different steps of the pipeline</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<em>str</em>) – path to folder</p></li>
<li><p><strong>components</strong> (<em>list</em><em> or </em><em>'all'</em>) – List of components to save. Options are: ‘embbedded_points’,</p></li>
<li><p><strong>'reduced_points'</strong> – </p></li>
<li><p><strong>'vectorizer'</strong> – </p></li>
<li><p><strong>'reducer'</strong> – </p></li>
<li><p><strong>default</strong> (<em>and 'clustering_model'. By</em>) – </p></li>
<li><p><strong>loads</strong> – </p></li>
<li><p><strong>param</strong> (<em>'all'</em><em> (</em><em>you can get all components by listing the class</em>) – TextClustering.components)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.clustering.TextClustering.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_parameter_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.clustering.TextClustering.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set parameters of clustering, reducer and vectorizer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> – A dictionary of parameters</p></li>
<li><p><strong>from_parameter_grid</strong> – Whether the dictionary is in the form of</p></li>
<li><p><strong>{'clustering__eps'</strong> (<em>sklearn parameter grid</em><em> (</em><em>e.g.</em>) – 1}), or a two</p></li>
<li><p><strong>{'clustering'</strong> (<em>level dictionary</em><em> (</em><em>e.g.</em>) – {‘eps’: 1}}) (default).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.clustering.TextClustering.stability">
<span class="sig-name descname"><span class="pre">stability</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.clustering.TextClustering.stability" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to calculate how stable the clusters are</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.cnn">
<span id="wellcomeml-ml-cnn-module"></span><h2>wellcomeml.ml.cnn module<a class="headerlink" href="#module-wellcomeml.ml.cnn" title="Permalink to this headline">¶</a></h2>
<p>CNN architecture inspired from spacy for NLP tasks</p>
<p>It follows the embed, encode, attend, predict framework</p>
<blockquote>
<div><p>Embed: learns a new embedding but can receive
pre trained embeddings as well</p>
<p>Encode: stacked CNN with context window 3 that maintains the size of input and applies dropout
and layer norm</p>
<p>Attend: not yet implemented</p>
<p>Predict: softmax or sigmoid depending on number of outputs
and whether task is multilabel</p>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.cnn.CNNClassifier">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.cnn.</span></span><span class="sig-name descname"><span class="pre">CNNClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multilabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'same'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['precision',</span> <span class="pre">'recall',</span> <span class="pre">'f1']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_approach</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stopping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensorboard_log_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'logs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.cnn.CNNClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.ClassifierMixin</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.cnn.CNNClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_per_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.cnn.CNNClassifier.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.cnn.CNNClassifier.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.cnn.CNNClassifier.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.cnn.CNNClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.cnn.CNNClassifier.predict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.cnn.CNNClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.cnn.CNNClassifier.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.cnn.CNNClassifier.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.cnn.CNNClassifier.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.cnn.CNNClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.cnn.CNNClassifier.score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.constants">
<span id="wellcomeml-ml-constants-module"></span><h2>wellcomeml.ml.constants module<a class="headerlink" href="#module-wellcomeml.ml.constants" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-wellcomeml.ml.doc2vec_vectorizer">
<span id="wellcomeml-ml-doc2vec-vectorizer-module"></span><h2>wellcomeml.ml.doc2vec_vectorizer module<a class="headerlink" href="#module-wellcomeml.ml.doc2vec_vectorizer" title="Permalink to this headline">¶</a></h2>
<p>Doc2Vec sklearn wrapper</p>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.doc2vec_vectorizer.Doc2VecVectorizer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.doc2vec_vectorizer.</span></span><span class="sig-name descname"><span class="pre">Doc2VecVectorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.025</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.doc2vec_vectorizer.Doc2VecVectorizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.doc2vec_vectorizer.Doc2VecVectorizer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.doc2vec_vectorizer.Doc2VecVectorizer.fit" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – list of texts (strings)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.doc2vec_vectorizer.Doc2VecVectorizer.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.doc2vec_vectorizer.Doc2VecVectorizer.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.doc2vec_vectorizer.Doc2VecVectorizer.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.doc2vec_vectorizer.Doc2VecVectorizer.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.doc2vec_vectorizer.Doc2VecVectorizer.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.doc2vec_vectorizer.Doc2VecVectorizer.score" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – list of texts (strings). Needs to be the same used for fit.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>percentage of documents that are most similar with themselves</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>score</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.doc2vec_vectorizer.Doc2VecVectorizer.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.doc2vec_vectorizer.Doc2VecVectorizer.transform" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – list of texts (strings)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>matrix of size (nb_docs, vector_size)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>docvectors</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.frequency_vectorizer">
<span id="wellcomeml-ml-frequency-vectorizer-module"></span><h2>wellcomeml.ml.frequency_vectorizer module<a class="headerlink" href="#module-wellcomeml.ml.frequency_vectorizer" title="Permalink to this headline">¶</a></h2>
<p>A generic “frequency” vectorizer that wraps all usual transformations.</p>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.frequency_vectorizer.WellcomeTfidf">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.frequency_vectorizer.</span></span><span class="sig-name descname"><span class="pre">WellcomeTfidf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_regex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_spacy_lemmatizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.frequency_vectorizer.WellcomeTfidf" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.feature_extraction.text.TfidfVectorizer</span></code></p>
<p>Class to wrap some basic transformation and text
vectorisation/embedding</p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.frequency_vectorizer.WellcomeTfidf.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.frequency_vectorizer.WellcomeTfidf.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.frequency_vectorizer.WellcomeTfidf.fit_transform">
<span class="sig-name descname"><span class="pre">fit_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.frequency_vectorizer.WellcomeTfidf.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.frequency_vectorizer.WellcomeTfidf.load_transformed">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">load_transformed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.frequency_vectorizer.WellcomeTfidf.load_transformed" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads transformed embedded vectors</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.frequency_vectorizer.WellcomeTfidf.regex_transform">
<span class="sig-name descname"><span class="pre">regex_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_numbers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'years'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.frequency_vectorizer.WellcomeTfidf.regex_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Extra regular expression transformations to clean text
:param X: A list of texts (strings)
:param *_:
:param remove_numbers: Whether to remove years or all digits. Caveat:
:param This does not only remove years:
:param but <strong>any number</strong> between:
:param 1000 and 2999.:</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A list of texts with the applied regex transformation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.frequency_vectorizer.WellcomeTfidf.save_transformed">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">save_transformed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_transformed</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.frequency_vectorizer.WellcomeTfidf.save_transformed" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves transformed embedded vectors</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.frequency_vectorizer.WellcomeTfidf.spacy_lemmatizer">
<span class="sig-name descname"><span class="pre">spacy_lemmatizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_stopwords_and_punct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.frequency_vectorizer.WellcomeTfidf.spacy_lemmatizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses spacy pre-trained lemmatisation model to
:param X: A list of texts (strings)
:param remove_stopwords_and_punct: Whether to remove stopwords,
:param punctuation:
:param pronouns:</p>
<p>Returns:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.frequency_vectorizer.WellcomeTfidf.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.frequency_vectorizer.WellcomeTfidf.transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.keras_utils">
<span id="wellcomeml-ml-keras-utils-module"></span><h2>wellcomeml.ml.keras_utils module<a class="headerlink" href="#module-wellcomeml.ml.keras_utils" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_utils.CategoricalMetrics">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.keras_utils.</span></span><span class="sig-name descname"><span class="pre">CategoricalMetrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_utils.CategoricalMetrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tensorflow.python.keras.metrics.Metric</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_utils.CategoricalMetrics.reset_states">
<span class="sig-name descname"><span class="pre">reset_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_utils.CategoricalMetrics.reset_states" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_utils.CategoricalMetrics.result">
<span class="sig-name descname"><span class="pre">result</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_utils.CategoricalMetrics.result" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_utils.CategoricalMetrics.update_state">
<span class="sig-name descname"><span class="pre">update_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_utils.CategoricalMetrics.update_state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_utils.MetricMiniBatchHistory">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.keras_utils.</span></span><span class="sig-name descname"><span class="pre">MetricMiniBatchHistory</span></span><a class="headerlink" href="#wellcomeml.ml.keras_utils.MetricMiniBatchHistory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tensorflow.python.keras.callbacks.Callback</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_utils.MetricMiniBatchHistory.on_batch_end">
<span class="sig-name descname"><span class="pre">on_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_utils.MetricMiniBatchHistory.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_utils.MetricMiniBatchHistory.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_utils.MetricMiniBatchHistory.on_train_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_utils.Metrics">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.keras_utils.</span></span><span class="sig-name descname"><span class="pre">Metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">validation_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">history_path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'micro'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_utils.Metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tensorflow.python.keras.callbacks.Callback</span></code></p>
<p>Calculate global F1, precision, and recall, against a complete test set
not just batch level metrics as with f1_metric.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="n">Metrics</span><span class="p">(</span><span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">),</span> <span class="n">history</span><span class="o">.</span><span class="n">csv</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">X_train</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">y_train</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">batch_size</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">early_stopping</span><span class="p">,</span> <span class="n">metrics</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_utils.Metrics.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_utils.Metrics.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_utils.Metrics.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_utils.Metrics.on_train_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_utils.Metrics.on_train_end">
<span class="sig-name descname"><span class="pre">on_train_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_utils.Metrics.on_train_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Write metrics to csv file</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.keras_vectorizer">
<span id="wellcomeml-ml-keras-vectorizer-module"></span><h2>wellcomeml.ml.keras_vectorizer module<a class="headerlink" href="#module-wellcomeml.ml.keras_vectorizer" title="Permalink to this headline">¶</a></h2>
<p>Implements KerasTokenizer that abstracts Keras tokenisation
and encoding and KerasVectorizer that is sklearn compatible</p>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_vectorizer.KerasTokenizer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.keras_vectorizer.</span></span><span class="sig-name descname"><span class="pre">KerasTokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oov_token</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&lt;OOV&gt;'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_vectorizer.KerasTokenizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_vectorizer.KerasTokenizer.decode">
<span class="sig-name descname"><span class="pre">decode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoded_text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_vectorizer.KerasTokenizer.decode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_vectorizer.KerasTokenizer.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_vectorizer.KerasTokenizer.encode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_vectorizer.KerasTokenizer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">texts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_vectorizer.KerasTokenizer.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_vectorizer.KerasTokenizer.tokenize">
<span class="sig-name descname"><span class="pre">tokenize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_vectorizer.KerasTokenizer.tokenize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_vectorizer.KerasTokenizer.vocab">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">vocab</span></span><a class="headerlink" href="#wellcomeml.ml.keras_vectorizer.KerasTokenizer.vocab" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_vectorizer.KerasVectorizer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.keras_vectorizer.</span></span><span class="sig-name descname"><span class="pre">KerasVectorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oov_token</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&lt;OOV&gt;'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer_library</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'keras'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_vectorizer.KerasVectorizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_vectorizer.KerasVectorizer.build_embedding_matrix">
<span class="sig-name descname"><span class="pre">build_embedding_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embeddings_name_or_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_vectorizer.KerasVectorizer.build_embedding_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds an embedding matrix from either a local embeddings path
or a gensim pre-trained word vector path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>embeddings_name_or_path</strong> – <p>Can be either:
- A local directory to word embeddings
- The name of a GenSim pre-trained word vector model</p>
<blockquote>
<div><p>e.g. ‘glove-twitter-25’, for the complete list:
<a class="reference external" href="https://github.com/RaRe-Technologies/gensim-data#models">https://github.com/RaRe-Technologies/gensim-data#models</a></p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An embedding matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_vectorizer.KerasVectorizer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_vectorizer.KerasVectorizer.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.keras_vectorizer.KerasVectorizer.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.keras_vectorizer.KerasVectorizer.transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.sent2vec_vectorizer">
<span id="wellcomeml-ml-sent2vec-vectorizer-module"></span><h2>wellcomeml.ml.sent2vec_vectorizer module<a class="headerlink" href="#module-wellcomeml.ml.sent2vec_vectorizer" title="Permalink to this headline">¶</a></h2>
<p>Vectorizer that exposes sklearn interface to sent2vec
paper and codebase. <a class="reference external" href="https://github.com/epfml/sent2vec">https://github.com/epfml/sent2vec</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.sent2vec_vectorizer.Sent2VecVectorizer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.sent2vec_vectorizer.</span></span><span class="sig-name descname"><span class="pre">Sent2VecVectorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.sent2vec_vectorizer.Sent2VecVectorizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.sent2vec_vectorizer.Sent2VecVectorizer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.sent2vec_vectorizer.Sent2VecVectorizer.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.sent2vec_vectorizer.Sent2VecVectorizer.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.sent2vec_vectorizer.Sent2VecVectorizer.transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.similarity_entity_linking">
<span id="wellcomeml-ml-similarity-entity-linking-module"></span><h2>wellcomeml.ml.similarity_entity_linking module<a class="headerlink" href="#module-wellcomeml.ml.similarity_entity_linking" title="Permalink to this headline">¶</a></h2>
<p>A class that for each of a list of sentences will find the most similar document in a corpus
using the TFIDF vectors or a BERT embedding from the corpus documents.</p>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.similarity_entity_linking.SimilarityEntityLinker">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.similarity_entity_linking.</span></span><span class="sig-name descname"><span class="pre">SimilarityEntityLinker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stopwords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tf-idf'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.similarity_entity_linking.SimilarityEntityLinker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.similarity_entity_linking.SimilarityEntityLinker.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.similarity_entity_linking.SimilarityEntityLinker.evaluate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.similarity_entity_linking.SimilarityEntityLinker.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">documents</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.similarity_entity_linking.SimilarityEntityLinker.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>documents: dictionary of the texts from each of the corpus documents</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.similarity_entity_linking.SimilarityEntityLinker.optimise_threshold">
<span class="sig-name descname"><span class="pre">optimise_threshold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'orcid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_id_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'No</span> <span class="pre">ORCID'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.similarity_entity_linking.SimilarityEntityLinker.optimise_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the f1 scores when different similarity thresholds are used.
Use half the maximum F1 score found as the optimal threshold.
This value will be used as the value for the similarity
threshold in predict, unless another value is given.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.similarity_entity_linking.SimilarityEntityLinker.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_id_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'No</span> <span class="pre">ORCID'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.similarity_entity_linking.SimilarityEntityLinker.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Identify the most similar document to a sentence using TFIDF</p>
<p>If the most similar document doesnt have a similarity value over
a threshold then return they key ‘No ORCID’</p>
<p>similarity_threshold can be specified, otherwise if you’ve optimised
the threshold it will use this value</p>
<dl class="simple">
<dt>Input:</dt><dd><dl class="simple">
<dt>data: a list of tuples in the form</dt><dd><p>[(‘A sentence about Farrar’,
{metadata}),
(‘A sentence about Smith’,
{metadata})]
For this predict function the contents of
{metadata} isn’t important</p>
</dd>
<dt>similarity_threshold: The threshold by which to</dt><dd><p>classify a match as being true or that there is
no match. If this is None then the best threshold
will be found</p>
</dd>
</dl>
</dd>
<dt>Output:</dt><dd><dl class="simple">
<dt>pred_entities: a list of predictions</dt><dd><p>of which document in the corpus each data
point is likely to link to
[‘0000-0002-2700-623X’, ‘0000-0002-6259-1606’, ‘No ORCID’]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.similarity_entity_linking.SimilarityEntityLinker.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.similarity_entity_linking.SimilarityEntityLinker.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns probability estimates for each class
in the same order as self.classifications</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.spacy_classifier">
<span id="wellcomeml-ml-spacy-classifier-module"></span><h2>wellcomeml.ml.spacy_classifier module<a class="headerlink" href="#module-wellcomeml.ml.spacy_classifier" title="Permalink to this headline">¶</a></h2>
<p>Train a convolutional neural network for multilabel classification
of grants
Adapted from <a class="reference external" href="https://github.com/explosion/spaCy/blob/master/examples/training/train_textcat.py">https://github.com/explosion/spaCy/blob/master/examples/training/train_textcat.py</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_classifier.SpacyClassifier">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.spacy_classifier.</span></span><span class="sig-name descname"><span class="pre">SpacyClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">architecture</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spacy.TextCatCNN.v1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multilabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_trained_vectors_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_classifier.SpacyClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.ClassifierMixin</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_classifier.SpacyClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_classifier.SpacyClassifier.fit" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – 1d list of documents</p></li>
<li><p><strong>Y</strong> – 2d numpy array (nb_examples, nb_labels)</p></li>
</ul>
</dd>
</dl>
<p>TODO: Generalise to y being 1d</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_classifier.SpacyClassifier.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_classifier.SpacyClassifier.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_classifier.SpacyClassifier.partial_fit">
<span class="sig-name descname"><span class="pre">partial_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_classifier.SpacyClassifier.partial_fit" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – 1d list of documents</p></li>
<li><p><strong>Y</strong> – 2d numpy array (nb_examples, nb_labels)</p></li>
</ul>
</dd>
</dl>
<p>TODO: Generalise to y being 1d</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_classifier.SpacyClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_classifier.SpacyClassifier.predict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_classifier.SpacyClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_classifier.SpacyClassifier.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_classifier.SpacyClassifier.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_classifier.SpacyClassifier.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_classifier.SpacyClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_classifier.SpacyClassifier.score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.spacy_entity_linking">
<span id="wellcomeml-ml-spacy-entity-linking-module"></span><h2>wellcomeml.ml.spacy_entity_linking module<a class="headerlink" href="#module-wellcomeml.ml.spacy_entity_linking" title="Permalink to this headline">¶</a></h2>
<p>TODO: Fill this</p>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_entity_linking.SpacyEntityLinker">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.spacy_entity_linking.</span></span><span class="sig-name descname"><span class="pre">SpacyEntityLinker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kb_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_entity_linking.SpacyEntityLinker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_entity_linking.SpacyEntityLinker.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_entity_linking.SpacyEntityLinker.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_entity_linking.SpacyEntityLinker.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_entity_linking.SpacyEntityLinker.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>See how well the model predicts which entity you are referring to in your data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – <p>list of test data in the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;A sentence about Farrar&#39;</span><span class="p">,</span>
<span class="p">{</span><span class="s1">&#39;links&#39;</span><span class="p">:</span> <span class="p">{(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">22</span><span class="p">):</span> <span class="p">{</span><span class="s1">&#39;Q1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}}})]</span>
</pre></div>
</div>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pred_entities_ids: [[‘Q1’], [‘Q1’], [‘Q2’]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_entity_linking.SpacyEntityLinker.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_entity_linking.SpacyEntityLinker.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_entity_linking.SpacyEntityLinker.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_entity_linking.SpacyEntityLinker.train" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – <p>list of training data in the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;A sentence about Farrar&#39;</span><span class="p">,</span>
<span class="p">{</span><span class="s1">&#39;links&#39;</span><span class="p">:</span> <span class="p">{(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">22</span><span class="p">):</span> <span class="p">{</span><span class="s1">&#39;Q1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}}})]</span>
</pre></div>
</div>
</p>
</dd>
</dl>
<p>See <a class="reference external" href="https://spacy.io/usage/linguistic-features#entity-linking">https://spacy.io/usage/linguistic-features#entity-linking</a>
for where I got this code from</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.spacy_knowledge_base">
<span id="wellcomeml-ml-spacy-knowledge-base-module"></span><h2>wellcomeml.ml.spacy_knowledge_base module<a class="headerlink" href="#module-wellcomeml.ml.spacy_knowledge_base" title="Permalink to this headline">¶</a></h2>
<p>Creates a knowledge base using the vocab from an NLP model
and pretrains the entity encodings using the entity descriptions</p>
<p>See <a class="reference external" href="https://spacy.io/usage/training#entity-linker">https://spacy.io/usage/training#entity-linker</a> for where I got this code from</p>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_knowledge_base.SpacyKnowledgeBase">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.spacy_knowledge_base.</span></span><span class="sig-name descname"><span class="pre">SpacyKnowledgeBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kb_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'en_core_web_lg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desc_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_knowledge_base.SpacyKnowledgeBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_knowledge_base.SpacyKnowledgeBase.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_knowledge_base.SpacyKnowledgeBase.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_knowledge_base.SpacyKnowledgeBase.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_knowledge_base.SpacyKnowledgeBase.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_knowledge_base.SpacyKnowledgeBase.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">entities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_aliases</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_knowledge_base.SpacyKnowledgeBase.train" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>entities</strong> – a dict of each entity, it’s description and it’s corpus frequency</p></li>
<li><p><strong>list_aliases</strong> – <p>a list of dicts for each entity e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span>
    <span class="s1">&#39;alias&#39;</span><span class="p">:</span><span class="s1">&#39;Farrar&#39;</span><span class="p">,</span>
    <span class="s1">&#39;entities&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">],</span>
    <span class="s1">&#39;probabilities&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
<span class="p">}]</span>
</pre></div>
</div>
<p>probabilities are ‘prior probabilities’ and must sum to &lt; 1</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.spacy_ner">
<span id="wellcomeml-ml-spacy-ner-module"></span><h2>wellcomeml.ml.spacy_ner module<a class="headerlink" href="#module-wellcomeml.ml.spacy_ner" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_ner.SpacyNER">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.spacy_ner.</span></span><span class="sig-name descname"><span class="pre">SpacyNER</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_ner.SpacyNER" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Train a spaCy NER classifier on texts annotated using Prodigy</p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_ner.SpacyNER.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_ner.SpacyNER.fit" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>X: a list of sentences,</dt><dd><p>e.g. [‘Professor Smith said’, ‘authors Smith and Chen found’]</p>
</dd>
<dt>y: a list of prodigy format spans for each element of X,</dt><dd><dl class="simple">
<dt>e.g. [{‘start’: 10, ‘end’: 15, ‘label’: ‘PERSON’},</dt><dd><p>{‘start’: 8, ‘end’: 13, ‘label’: ‘PERSON’},
{‘start’:18, ‘end’:22, ‘label’:’PERSON’}]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_ner.SpacyNER.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_ner.SpacyNER.load" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>model:</dt><dd><p>The model’s location (‘models/model’)
or the name of a spaCy model (“en_core_web_sm”)
None (default): Then load a blank spacy english model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_ner.SpacyNER.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_ner.SpacyNER.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get entity predictions for a piece of text</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_ner.SpacyNER.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_ner.SpacyNER.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.spacy_ner.SpacyNER.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.spacy_ner.SpacyNER.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the model’s performance on the data
for entity types in the ‘tags’ list, e.g. [‘PERSON’, ‘LOC’]</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.transformers_tokenizer">
<span id="wellcomeml-ml-transformers-tokenizer-module"></span><h2>wellcomeml.ml.transformers_tokenizer module<a class="headerlink" href="#module-wellcomeml.ml.transformers_tokenizer" title="Permalink to this headline">¶</a></h2>
<p>Implements Tokenizer that abstracts common tokenisation
strategies used in Transformers</p>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.transformers_tokenizer.TransformersTokenizer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.transformers_tokenizer.</span></span><span class="sig-name descname"><span class="pre">TransformersTokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lowercase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'whitespace'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wordpiece'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unk_token</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'[UNK]'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.transformers_tokenizer.TransformersTokenizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.transformers_tokenizer.TransformersTokenizer.decode">
<span class="sig-name descname"><span class="pre">decode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoded_text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.transformers_tokenizer.TransformersTokenizer.decode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.transformers_tokenizer.TransformersTokenizer.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.transformers_tokenizer.TransformersTokenizer.encode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.transformers_tokenizer.TransformersTokenizer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">texts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.transformers_tokenizer.TransformersTokenizer.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.transformers_tokenizer.TransformersTokenizer.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokenizer_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.transformers_tokenizer.TransformersTokenizer.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.transformers_tokenizer.TransformersTokenizer.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokenizer_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.transformers_tokenizer.TransformersTokenizer.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.transformers_tokenizer.TransformersTokenizer.tokenize">
<span class="sig-name descname"><span class="pre">tokenize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.transformers_tokenizer.TransformersTokenizer.tokenize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wellcomeml.ml.transformers_tokenizer.TransformersTokenizer.vocab">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">vocab</span></span><a class="headerlink" href="#wellcomeml.ml.transformers_tokenizer.TransformersTokenizer.vocab" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.vectorizer">
<span id="wellcomeml-ml-vectorizer-module"></span><h2>wellcomeml.ml.vectorizer module<a class="headerlink" href="#module-wellcomeml.ml.vectorizer" title="Permalink to this headline">¶</a></h2>
<p>A generic vectorizer that can fallback to tdidf or bag of words from sklearn
or embed using bert, doc2vec etc</p>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.vectorizer.Vectorizer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.vectorizer.</span></span><span class="sig-name descname"><span class="pre">Vectorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tf-idf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.vectorizer.Vectorizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<p>Abstract class, sklearn-compatible, that can vectorize texts using
various models.</p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.vectorizer.Vectorizer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.vectorizer.Vectorizer.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.vectorizer.Vectorizer.fit_transform">
<span class="sig-name descname"><span class="pre">fit_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.vectorizer.Vectorizer.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.vectorizer.Vectorizer.load_transformed">
<span class="sig-name descname"><span class="pre">load_transformed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.vectorizer.Vectorizer.load_transformed" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads transformed vector X_transformed vector, using the corresponding
load method for the specific vectorizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> – A path to the file containing embedded vectors</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>X_transformed (array), like the one returned by the the
fit_transform function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.vectorizer.Vectorizer.save_transformed">
<span class="sig-name descname"><span class="pre">save_transformed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_transformed</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.vectorizer.Vectorizer.save_transformed" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves transformed vector X_transformed vector, using the corresponding
save_transformed method for the specific vectorizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – A path to the embedding file</p></li>
<li><p><strong>X_transformed</strong> – A transformed vector (as output by using the</p></li>
<li><p><strong>method</strong><strong>)</strong> (<em>transform</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.vectorizer.Vectorizer.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.vectorizer.Vectorizer.transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml.voting_classifier">
<span id="wellcomeml-ml-voting-classifier-module"></span><h2>wellcomeml.ml.voting_classifier module<a class="headerlink" href="#module-wellcomeml.ml.voting_classifier" title="Permalink to this headline">¶</a></h2>
<p>Voting classifier with ability to accept pretrained estimators
and return results for multilabel Y</p>
<p>Some of the code is taken from <a class="reference external" href="https://gist.github.com/tomquisel/a421235422fdf6b51ec2ccc5e3dee1b4">https://gist.github.com/tomquisel/a421235422fdf6b51ec2ccc5e3dee1b4</a></p>
<dl>
<dt>voting = “soft”:</dt><dd><dl class="simple">
<dt>multilabel = True:</dt><dd><p>The predicted classes will be any classes where the mean probability from all the</p>
</dd>
</dl>
<p>estimators is &gt; 0.5.
multilabel = False:</p>
<blockquote>
<div><p>The predicted class will be class with the largest mean probability from all the
estimators.</p>
</div></blockquote>
</dd>
<dt>voting = “hard”:</dt><dd><p>The predicted class(es) will be any class(es) where the majority (or &gt;= num_agree) of
estimators agree. Majority in even cases is 2/2 or &gt;=3/4 (i.e. not 2/4).</p>
<p>If there are multiple classes with the majority (a tie) then the first one in
numerical order will be chosen.</p>
<p>In the multiclass case, if there are multiple classes with &gt;= num_agree, then the
predicted class will be the first class in a numerically sorted list of the tying classes.
e.g.</p>
<blockquote>
<div><p>If there is 1 vote for class 0, 2 votes for class 1 and 2 votes for class 2,
then class 1 will be predicted.</p>
</div></blockquote>
<p>In the binary case, if there is a tie then class 0 is predicted.
e.g.</p>
<blockquote>
<div><dl class="simple">
<dt>If there are 2 votes for class 0 and 2 votes for class 1, then class 0</dt><dd><p>will be predicted.</p>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.voting_classifier.WellcomeVotingClassifier">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.voting_classifier.</span></span><span class="sig-name descname"><span class="pre">WellcomeVotingClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multilabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_agree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.voting_classifier.WellcomeVotingClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.ensemble._voting.VotingClassifier</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.voting_classifier.WellcomeVotingClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.voting_classifier.WellcomeVotingClassifier.predict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wellcomeml.ml.voting_classifier.WellcomeVotingClassifier.steps">
<span class="sig-name descname"><span class="pre">steps</span></span><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#wellcomeml.ml.voting_classifier.WellcomeVotingClassifier.steps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wellcomeml.ml">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-wellcomeml.ml" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.BertClassifier">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.</span></span><span class="sig-name descname"><span class="pre">BertClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bert-base-uncased'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multilabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_pt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BertClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<p>Class to fine-tune BERT like models for a text
classification task</p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.BertClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BertClassifier.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fine tune BERT to text data and Y vector</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – list or numpy array of texts (n_samples,)</p></li>
<li><p><strong>Y</strong> – list or numpy array of classes (n_samples, n_classes)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.BertClassifier.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BertClassifier.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads model from directory model_path. Tokenizer initialised from param pretrained</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.BertClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BertClassifier.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict vector Y on text data X</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – list or numpy array of texts (n_samples)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy array of predictions Y (n_samples, n_classes)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Y_pred</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.BertClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BertClassifier.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict probabilities for classes on text data X</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – list or numpy arrray of texts (n_samples)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy array of probabilities for each class (n_samples, n_classes)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Y_pred_proba</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.BertClassifier.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BertClassifier.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves model in directory model_path</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.BertClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BertClassifier.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Micro f1 score of X data against ground truth Y</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.BertVectorizer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.</span></span><span class="sig-name descname"><span class="pre">BertVectorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bert'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean_second_to_last'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BertVectorizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.BertVectorizer.bert_embedding">
<span class="sig-name descname"><span class="pre">bert_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BertVectorizer.bert_embedding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.BertVectorizer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BertVectorizer.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.BertVectorizer.load_transformed">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">load_transformed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BertVectorizer.load_transformed" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads transformed embedded vectors</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.BertVectorizer.save_transformed">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">save_transformed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_transformed</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BertVectorizer.save_transformed" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves transformed embedded vectors</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.BertVectorizer.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BertVectorizer.transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.BiLSTMClassifier">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.</span></span><span class="sig-name descname"><span class="pre">BiLSTMClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'same'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multilabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['precision',</span> <span class="pre">'recall']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['tensorboard']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_approach</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stopping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BiLSTMClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.ClassifierMixin</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.BiLSTMClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BiLSTMClassifier.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.BiLSTMClassifier.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BiLSTMClassifier.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.BiLSTMClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BiLSTMClassifier.predict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.BiLSTMClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BiLSTMClassifier.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.BiLSTMClassifier.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BiLSTMClassifier.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.BiLSTMClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.BiLSTMClassifier.score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.CNNClassifier">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.</span></span><span class="sig-name descname"><span class="pre">CNNClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multilabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'same'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['precision',</span> <span class="pre">'recall',</span> <span class="pre">'f1']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_approach</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stopping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensorboard_log_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'logs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.CNNClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.ClassifierMixin</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.CNNClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_per_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.CNNClassifier.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.CNNClassifier.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.CNNClassifier.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.CNNClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.CNNClassifier.predict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.CNNClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.CNNClassifier.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.CNNClassifier.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.CNNClassifier.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.CNNClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.CNNClassifier.score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.Doc2VecVectorizer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.</span></span><span class="sig-name descname"><span class="pre">Doc2VecVectorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.025</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.Doc2VecVectorizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.Doc2VecVectorizer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.Doc2VecVectorizer.fit" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – list of texts (strings)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.Doc2VecVectorizer.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.Doc2VecVectorizer.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.Doc2VecVectorizer.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.Doc2VecVectorizer.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.Doc2VecVectorizer.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.Doc2VecVectorizer.score" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – list of texts (strings). Needs to be the same used for fit.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>percentage of documents that are most similar with themselves</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>score</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.Doc2VecVectorizer.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.Doc2VecVectorizer.transform" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – list of texts (strings)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>matrix of size (nb_docs, vector_size)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>docvectors</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.KerasVectorizer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.</span></span><span class="sig-name descname"><span class="pre">KerasVectorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oov_token</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&lt;OOV&gt;'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer_library</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'keras'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.KerasVectorizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.KerasVectorizer.build_embedding_matrix">
<span class="sig-name descname"><span class="pre">build_embedding_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embeddings_name_or_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.KerasVectorizer.build_embedding_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds an embedding matrix from either a local embeddings path
or a gensim pre-trained word vector path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>embeddings_name_or_path</strong> – <p>Can be either:
- A local directory to word embeddings
- The name of a GenSim pre-trained word vector model</p>
<blockquote>
<div><p>e.g. ‘glove-twitter-25’, for the complete list:
<a class="reference external" href="https://github.com/RaRe-Technologies/gensim-data#models">https://github.com/RaRe-Technologies/gensim-data#models</a></p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An embedding matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.KerasVectorizer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.KerasVectorizer.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.KerasVectorizer.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.KerasVectorizer.transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.SemanticEquivalenceClassifier">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.</span></span><span class="sig-name descname"><span class="pre">SemanticEquivalenceClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bert'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logging_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensorflow_log_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'logs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SemanticEquivalenceClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<p>Class to fine-tune BERT-type models for semantic equivalence, for example
paraphrase, textual similarity and other NLU tasks</p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SemanticEquivalenceClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SemanticEquivalenceClassifier.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits a sentence similarity model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – List of 2-uples: [(‘Sentence 1’, ‘Sentence 2’), ….]</p></li>
<li><p><strong>y</strong> – list of 0 (not similar) and 1s (similar)</p></li>
<li><p><strong>random_state</strong> – a random state for the train_test_split</p></li>
<li><p><strong>epochs</strong> – number_of epochs</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A fitted model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SemanticEquivalenceClassifier.initialise_models">
<span class="sig-name descname"><span class="pre">initialise_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SemanticEquivalenceClassifier.initialise_models" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SemanticEquivalenceClassifier.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SemanticEquivalenceClassifier.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads model from path</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SemanticEquivalenceClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SemanticEquivalenceClassifier.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the predicted class (0 - for negative and 1 for positive)
for X.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – List of 2-uples: [(‘Sentence 1’, ‘Sentence 2’), ….]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An array of 0s and 1s</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SemanticEquivalenceClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SemanticEquivalenceClassifier.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates scores for model prediction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – List of 2-uples: [(‘Sentence 1’, ‘Sentence 2’), ….]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An array of shape len(X) x 2 with scores for classes 0 and 1</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SemanticEquivalenceClassifier.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SemanticEquivalenceClassifier.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves model to path</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.Sent2VecVectorizer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.</span></span><span class="sig-name descname"><span class="pre">Sent2VecVectorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.Sent2VecVectorizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.Sent2VecVectorizer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.Sent2VecVectorizer.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.Sent2VecVectorizer.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.Sent2VecVectorizer.transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.SimilarityEntityLinker">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.</span></span><span class="sig-name descname"><span class="pre">SimilarityEntityLinker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stopwords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tf-idf'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SimilarityEntityLinker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SimilarityEntityLinker.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SimilarityEntityLinker.evaluate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SimilarityEntityLinker.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">documents</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SimilarityEntityLinker.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>documents: dictionary of the texts from each of the corpus documents</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SimilarityEntityLinker.optimise_threshold">
<span class="sig-name descname"><span class="pre">optimise_threshold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'orcid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_id_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'No</span> <span class="pre">ORCID'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SimilarityEntityLinker.optimise_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the f1 scores when different similarity thresholds are used.
Use half the maximum F1 score found as the optimal threshold.
This value will be used as the value for the similarity
threshold in predict, unless another value is given.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SimilarityEntityLinker.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_id_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'No</span> <span class="pre">ORCID'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SimilarityEntityLinker.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Identify the most similar document to a sentence using TFIDF</p>
<p>If the most similar document doesnt have a similarity value over
a threshold then return they key ‘No ORCID’</p>
<p>similarity_threshold can be specified, otherwise if you’ve optimised
the threshold it will use this value</p>
<dl class="simple">
<dt>Input:</dt><dd><dl class="simple">
<dt>data: a list of tuples in the form</dt><dd><p>[(‘A sentence about Farrar’,
{metadata}),
(‘A sentence about Smith’,
{metadata})]
For this predict function the contents of
{metadata} isn’t important</p>
</dd>
<dt>similarity_threshold: The threshold by which to</dt><dd><p>classify a match as being true or that there is
no match. If this is None then the best threshold
will be found</p>
</dd>
</dl>
</dd>
<dt>Output:</dt><dd><dl class="simple">
<dt>pred_entities: a list of predictions</dt><dd><p>of which document in the corpus each data
point is likely to link to
[‘0000-0002-2700-623X’, ‘0000-0002-6259-1606’, ‘No ORCID’]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SimilarityEntityLinker.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SimilarityEntityLinker.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns probability estimates for each class
in the same order as self.classifications</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyClassifier">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.</span></span><span class="sig-name descname"><span class="pre">SpacyClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">architecture</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spacy.TextCatCNN.v1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multilabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_trained_vectors_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.ClassifierMixin</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyClassifier.fit" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – 1d list of documents</p></li>
<li><p><strong>Y</strong> – 2d numpy array (nb_examples, nb_labels)</p></li>
</ul>
</dd>
</dl>
<p>TODO: Generalise to y being 1d</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyClassifier.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyClassifier.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyClassifier.partial_fit">
<span class="sig-name descname"><span class="pre">partial_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyClassifier.partial_fit" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – 1d list of documents</p></li>
<li><p><strong>Y</strong> – 2d numpy array (nb_examples, nb_labels)</p></li>
</ul>
</dd>
</dl>
<p>TODO: Generalise to y being 1d</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyClassifier.predict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyClassifier.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyClassifier.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyClassifier.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyClassifier.score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyEntityLinker">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.</span></span><span class="sig-name descname"><span class="pre">SpacyEntityLinker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kb_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyEntityLinker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyEntityLinker.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyEntityLinker.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyEntityLinker.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyEntityLinker.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>See how well the model predicts which entity you are referring to in your data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – <p>list of test data in the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;A sentence about Farrar&#39;</span><span class="p">,</span>
<span class="p">{</span><span class="s1">&#39;links&#39;</span><span class="p">:</span> <span class="p">{(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">22</span><span class="p">):</span> <span class="p">{</span><span class="s1">&#39;Q1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}}})]</span>
</pre></div>
</div>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pred_entities_ids: [[‘Q1’], [‘Q1’], [‘Q2’]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyEntityLinker.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyEntityLinker.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyEntityLinker.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyEntityLinker.train" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – <p>list of training data in the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;A sentence about Farrar&#39;</span><span class="p">,</span>
<span class="p">{</span><span class="s1">&#39;links&#39;</span><span class="p">:</span> <span class="p">{(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">22</span><span class="p">):</span> <span class="p">{</span><span class="s1">&#39;Q1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}}})]</span>
</pre></div>
</div>
</p>
</dd>
</dl>
<p>See <a class="reference external" href="https://spacy.io/usage/linguistic-features#entity-linking">https://spacy.io/usage/linguistic-features#entity-linking</a>
for where I got this code from</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyKnowledgeBase">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.</span></span><span class="sig-name descname"><span class="pre">SpacyKnowledgeBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kb_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'en_core_web_lg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desc_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyKnowledgeBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyKnowledgeBase.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyKnowledgeBase.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyKnowledgeBase.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyKnowledgeBase.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyKnowledgeBase.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">entities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_aliases</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyKnowledgeBase.train" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>entities</strong> – a dict of each entity, it’s description and it’s corpus frequency</p></li>
<li><p><strong>list_aliases</strong> – <p>a list of dicts for each entity e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span>
    <span class="s1">&#39;alias&#39;</span><span class="p">:</span><span class="s1">&#39;Farrar&#39;</span><span class="p">,</span>
    <span class="s1">&#39;entities&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">],</span>
    <span class="s1">&#39;probabilities&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
<span class="p">}]</span>
</pre></div>
</div>
<p>probabilities are ‘prior probabilities’ and must sum to &lt; 1</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyNER">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.</span></span><span class="sig-name descname"><span class="pre">SpacyNER</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyNER" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Train a spaCy NER classifier on texts annotated using Prodigy</p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyNER.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyNER.fit" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>X: a list of sentences,</dt><dd><p>e.g. [‘Professor Smith said’, ‘authors Smith and Chen found’]</p>
</dd>
<dt>y: a list of prodigy format spans for each element of X,</dt><dd><dl class="simple">
<dt>e.g. [{‘start’: 10, ‘end’: 15, ‘label’: ‘PERSON’},</dt><dd><p>{‘start’: 8, ‘end’: 13, ‘label’: ‘PERSON’},
{‘start’:18, ‘end’:22, ‘label’:’PERSON’}]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyNER.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyNER.load" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>model:</dt><dd><p>The model’s location (‘models/model’)
or the name of a spaCy model (“en_core_web_sm”)
None (default): Then load a blank spacy english model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyNER.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyNER.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get entity predictions for a piece of text</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyNER.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyNER.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.SpacyNER.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.SpacyNER.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the model’s performance on the data
for entity types in the ‘tags’ list, e.g. [‘PERSON’, ‘LOC’]</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.TextClustering">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.</span></span><span class="sig-name descname"><span class="pre">TextClustering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tf-idf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reducer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'umap'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clustering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dbscan'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_reduced</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reducer_random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clustering_random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.TextClustering" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Basic class for clustering pipelines.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="wellcomeml.ml.TextClustering.vectorizer">
<span class="sig-name descname"><span class="pre">vectorizer</span></span><a class="headerlink" href="#wellcomeml.ml.TextClustering.vectorizer" title="Permalink to this definition">¶</a></dt>
<dd><p>The embedding Vectorizer object</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wellcomeml.ml.TextClustering.reducer">
<span class="sig-name descname"><span class="pre">reducer</span></span><a class="headerlink" href="#wellcomeml.ml.TextClustering.reducer" title="Permalink to this definition">¶</a></dt>
<dd><p>A dimensionality reduction object</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wellcomeml.ml.TextClustering.clustering">
<span class="sig-name descname"><span class="pre">clustering</span></span><a class="headerlink" href="#wellcomeml.ml.TextClustering.clustering" title="Permalink to this definition">¶</a></dt>
<dd><p>A clustering model object</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wellcomeml.ml.TextClustering.cluster_ids">
<span class="sig-name descname"><span class="pre">cluster_ids</span></span><a class="headerlink" href="#wellcomeml.ml.TextClustering.cluster_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Ids of the cluster</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wellcomeml.ml.TextClustering.cluster_names">
<span class="sig-name descname"><span class="pre">cluster_names</span></span><a class="headerlink" href="#wellcomeml.ml.TextClustering.cluster_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of the clusters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wellcomeml.ml.TextClustering.cluster_kws">
<span class="sig-name descname"><span class="pre">cluster_kws</span></span><a class="headerlink" href="#wellcomeml.ml.TextClustering.cluster_kws" title="Permalink to this definition">¶</a></dt>
<dd><p>Keywords for the clusters (only if embedding=tf-idf)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.TextClustering.break_cluster">
<span class="sig-name descname"><span class="pre">break_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.TextClustering.break_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Breaks a specific by re-clustering a subset</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.TextClustering.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.TextClustering.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits all clusters in the pipeline</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – A list of texts</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A TextClustering object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.TextClustering.fit_step">
<span class="sig-name descname"><span class="pre">fit_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vectorizer'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.TextClustering.fit_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal function for partial fitting only a certain step</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.TextClustering.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.TextClustering.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the different steps of the pipeline</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<em>str</em>) – path to folder</p></li>
<li><p><strong>components</strong> (<em>list</em><em> or </em><em>'all'</em>) – List of components to load. Options are: ‘embbedded_points’,</p></li>
<li><p><strong>'reduced_points'</strong> – </p></li>
<li><p><strong>'vectorizer'</strong> – </p></li>
<li><p><strong>'reducer'</strong> – </p></li>
<li><p><strong>default</strong> (<em>and 'clustering_model'. By</em>) – </p></li>
<li><p><strong>loads</strong> – </p></li>
<li><p><strong>param</strong> (<em>'all'</em><em> (</em><em>you can get all components by listing the class</em>) – TextClustering.components)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.TextClustering.merge_clusters">
<span class="sig-name descname"><span class="pre">merge_clusters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictionary</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.TextClustering.merge_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge cluster based on ids</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.TextClustering.optimise">
<span class="sig-name descname"><span class="pre">optimise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cluster_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.TextClustering.optimise" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimises the clustering silhouette based on a parameter grid,
a range on number of clusters and a range on noise.</p>
<p>It is customised to avoid re-fitting of intermediate
steps (vectorizer and reducer) more than necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>iterable</em><em>[</em><em>str</em><em>]</em>) – A list of texts to be clustered</p></li>
<li><p><strong>param_grid</strong> (<em>dict</em>) – A parameter grid, example:
param_grid = {‘reducer’: {‘min_dist’: [0.0, 0.2], ‘n_neighbors’: [2,3,5],
‘metric’: [‘cosine’, ‘euclidean’]},
‘clustering’: {‘min_samples’: [2, 5], ‘eps’: [0.5, 1, 1.5]}}</p></li>
<li><p><strong>n_cluster_range</strong> (<em>2-uple of ints</em>) – A 2-uple describing the max and min number
of clusters (e.g.: (10, 20)). If unset, will just choose the best silhouette</p></li>
<li><p><strong>max_noise</strong> (<em>float in</em><em> [</em><em>0</em><em>,</em><em>1</em><em>]</em>) – The maximum fraction of points unclustered. Default: 0.2</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>A dictionary of results.</p>
<p>The function returns a dictionary containing  “params_list”, “silhouette”
(the silhouette for each parameter) and “best_clustering”
(the best clustering parameters)</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.TextClustering.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.TextClustering.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the different steps of the pipeline</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<em>str</em>) – path to folder</p></li>
<li><p><strong>components</strong> (<em>list</em><em> or </em><em>'all'</em>) – List of components to save. Options are: ‘embbedded_points’,</p></li>
<li><p><strong>'reduced_points'</strong> – </p></li>
<li><p><strong>'vectorizer'</strong> – </p></li>
<li><p><strong>'reducer'</strong> – </p></li>
<li><p><strong>default</strong> (<em>and 'clustering_model'. By</em>) – </p></li>
<li><p><strong>loads</strong> – </p></li>
<li><p><strong>param</strong> (<em>'all'</em><em> (</em><em>you can get all components by listing the class</em>) – TextClustering.components)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.TextClustering.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_parameter_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.TextClustering.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set parameters of clustering, reducer and vectorizer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> – A dictionary of parameters</p></li>
<li><p><strong>from_parameter_grid</strong> – Whether the dictionary is in the form of</p></li>
<li><p><strong>{'clustering__eps'</strong> (<em>sklearn parameter grid</em><em> (</em><em>e.g.</em>) – 1}), or a two</p></li>
<li><p><strong>{'clustering'</strong> (<em>level dictionary</em><em> (</em><em>e.g.</em>) – {‘eps’: 1}}) (default).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.TextClustering.stability">
<span class="sig-name descname"><span class="pre">stability</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.TextClustering.stability" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to calculate how stable the clusters are</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.TransformersTokenizer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.</span></span><span class="sig-name descname"><span class="pre">TransformersTokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lowercase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'whitespace'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wordpiece'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unk_token</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'[UNK]'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.TransformersTokenizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.TransformersTokenizer.decode">
<span class="sig-name descname"><span class="pre">decode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoded_text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.TransformersTokenizer.decode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.TransformersTokenizer.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.TransformersTokenizer.encode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.TransformersTokenizer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">texts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.TransformersTokenizer.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.TransformersTokenizer.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokenizer_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.TransformersTokenizer.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.TransformersTokenizer.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokenizer_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.TransformersTokenizer.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.TransformersTokenizer.tokenize">
<span class="sig-name descname"><span class="pre">tokenize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.TransformersTokenizer.tokenize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wellcomeml.ml.TransformersTokenizer.vocab">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">vocab</span></span><a class="headerlink" href="#wellcomeml.ml.TransformersTokenizer.vocab" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.Vectorizer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.</span></span><span class="sig-name descname"><span class="pre">Vectorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tf-idf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.Vectorizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<p>Abstract class, sklearn-compatible, that can vectorize texts using
various models.</p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.Vectorizer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.Vectorizer.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.Vectorizer.fit_transform">
<span class="sig-name descname"><span class="pre">fit_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.Vectorizer.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.Vectorizer.load_transformed">
<span class="sig-name descname"><span class="pre">load_transformed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.Vectorizer.load_transformed" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads transformed vector X_transformed vector, using the corresponding
load method for the specific vectorizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> – A path to the file containing embedded vectors</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>X_transformed (array), like the one returned by the the
fit_transform function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.Vectorizer.save_transformed">
<span class="sig-name descname"><span class="pre">save_transformed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_transformed</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.Vectorizer.save_transformed" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves transformed vector X_transformed vector, using the corresponding
save_transformed method for the specific vectorizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – A path to the embedding file</p></li>
<li><p><strong>X_transformed</strong> – A transformed vector (as output by using the</p></li>
<li><p><strong>method</strong><strong>)</strong> (<em>transform</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.Vectorizer.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.Vectorizer.transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.WellcomeTfidf">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.</span></span><span class="sig-name descname"><span class="pre">WellcomeTfidf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_regex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_spacy_lemmatizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.WellcomeTfidf" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.feature_extraction.text.TfidfVectorizer</span></code></p>
<p>Class to wrap some basic transformation and text
vectorisation/embedding</p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.WellcomeTfidf.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.WellcomeTfidf.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.WellcomeTfidf.fit_transform">
<span class="sig-name descname"><span class="pre">fit_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.WellcomeTfidf.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.WellcomeTfidf.load_transformed">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">load_transformed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.WellcomeTfidf.load_transformed" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads transformed embedded vectors</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.WellcomeTfidf.regex_transform">
<span class="sig-name descname"><span class="pre">regex_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_numbers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'years'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.WellcomeTfidf.regex_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Extra regular expression transformations to clean text
:param X: A list of texts (strings)
:param *_:
:param remove_numbers: Whether to remove years or all digits. Caveat:
:param This does not only remove years:
:param but <strong>any number</strong> between:
:param 1000 and 2999.:</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A list of texts with the applied regex transformation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.WellcomeTfidf.save_transformed">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">save_transformed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_transformed</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.WellcomeTfidf.save_transformed" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves transformed embedded vectors</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.WellcomeTfidf.spacy_lemmatizer">
<span class="sig-name descname"><span class="pre">spacy_lemmatizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_stopwords_and_punct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.WellcomeTfidf.spacy_lemmatizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses spacy pre-trained lemmatisation model to
:param X: A list of texts (strings)
:param remove_stopwords_and_punct: Whether to remove stopwords,
:param punctuation:
:param pronouns:</p>
<p>Returns:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.WellcomeTfidf.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.WellcomeTfidf.transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wellcomeml.ml.WellcomeVotingClassifier">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">wellcomeml.ml.</span></span><span class="sig-name descname"><span class="pre">WellcomeVotingClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multilabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_agree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.WellcomeVotingClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.ensemble._voting.VotingClassifier</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wellcomeml.ml.WellcomeVotingClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wellcomeml.ml.WellcomeVotingClassifier.predict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wellcomeml.ml.WellcomeVotingClassifier.steps">
<span class="sig-name descname"><span class="pre">steps</span></span><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#wellcomeml.ml.WellcomeVotingClassifier.steps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="wellcomeml.spacy.html" class="btn btn-neutral float-right" title="wellcomeml.spacy package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="wellcomeml.metrics.html" class="btn btn-neutral float-left" title="wellcomeml.metrics package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Wellcome Data Labs.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>